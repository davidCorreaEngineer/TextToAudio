<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Google TTS Generator</title>
    
    <!-- **1. Included Bootstrap CSS for Modern UI and Responsive Design** -->
    <link
        rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
    />
    
    <!-- **2. Included Chart.js for Data Visualization** -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- **3. Included Font Awesome for Icons** -->
    <link
        rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
        crossorigin="anonymous"
        referrerpolicy="no-referrer"
    />
    
    <style>
        body { 
            font-family: Arial, sans-serif; 
            background-color: #f8f9fa; 
        }
        /* **4. Styled Drag-and-Drop Zone** */
        #dropZone {
            background-color: #ffffff;
            border: 2px dashed #ced4da;
            border-radius: 5px;
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
        }
		#pauseDurationContainer {
            display: none;
            margin-top: 10px;
        }
        #dropZone.dragover {
            background-color: #e9ecef;
            border-color: #495057;
        }
        /* **5. Styled Progress Bar** */
        #progressContainer {
            display: none;
            margin-top: 20px;
        }
        /* **6. Styled Advanced Settings Section** */
        #advancedSettings {
            margin-top: 20px;
        }
        /* **7. Styled Text Preview Area** */
        #textPreview {
            resize: vertical;
        }
        /* **7.1 Input Mode Toggle Styling** */
        .input-mode-toggle {
            display: flex;
            margin-bottom: 15px;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            overflow: hidden;
        }
        .input-mode-toggle .btn {
            flex: 1;
            border-radius: 0;
            border: none;
            padding: 12px 20px;
            font-weight: 500;
        }
        .input-mode-toggle .btn.active {
            background-color: #007bff;
            color: white;
        }
        .input-mode-toggle .btn:not(.active) {
            background-color: #f8f9fa;
            color: #495057;
        }
        .input-mode-toggle .btn:not(.active):hover {
            background-color: #e9ecef;
        }
        /* **7.2 Text Editor Styling** */
        #textEditorContainer {
            display: none;
        }
        #textEditor {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.5;
            resize: vertical;
            min-height: 300px;
        }
        .ssml-toolbar {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-bottom: none;
            border-radius: 5px 5px 0 0;
            padding: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }
        .ssml-toolbar .btn {
            font-size: 12px;
            padding: 4px 8px;
        }
        .ssml-toolbar .btn i {
            margin-right: 4px;
        }
        #textEditor.with-toolbar {
            border-radius: 0 0 5px 5px;
        }
        /* **7.3 Paragraph Preview Styling** */
        .paragraph-preview-container {
            position: relative;
        }
        .preview-paragraph-btn {
            position: absolute;
            right: 10px;
            bottom: 10px;
            z-index: 10;
        }
        .char-count {
            font-size: 12px;
            color: #6c757d;
            text-align: right;
            margin-top: 5px;
        }
        .char-count.warning {
            color: #ffc107;
        }
        .char-count.danger {
            color: #dc3545;
        }
        /* **7.4 Selection Preview Styling** */
        #selectionPreviewContainer {
            background-color: #e9ecef;
            border-radius: 5px;
            padding: 10px;
            margin-top: 10px;
            display: none;
        }
        #selectionPreviewContainer.show {
            display: block;
        }
        #selectedTextDisplay {
            font-style: italic;
            color: #495057;
            margin-bottom: 10px;
            max-height: 60px;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        /* **8. Tab Navigation Styling** */
        .nav-tabs {
            border-bottom: 2px solid #dee2e6;
        }
        .nav-tabs .nav-link {
            border: none;
            border-bottom: 3px solid transparent;
            color: #6c757d;
            font-weight: 500;
            padding: 12px 20px;
            transition: all 0.2s ease;
        }
        .nav-tabs .nav-link:hover {
            border-color: transparent;
            border-bottom: 3px solid #adb5bd;
            color: #495057;
        }
        .nav-tabs .nav-link.active {
            border: none;
            border-bottom: 3px solid #007bff;
            color: #007bff;
            background-color: transparent;
        }
        .nav-tabs .nav-link i {
            margin-right: 8px;
        }
        .tab-content {
            padding-top: 10px;
        }
        /* **9. Dashboard Styling** */
        #dashboard h2 {
            margin-bottom: 20px;
        }
        /* **9. Summary Cards Styling** */
        .summary-card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            padding: 20px;
            background-color: #ffffff;
            text-align: center;
            transition: transform 0.2s;
        }
        .summary-card:hover {
            transform: translateY(-5px);
        }
        .summary-card h5 {
            margin-bottom: 10px;
            color: #6c757d;
        }
        .summary-card p {
            font-size: 1.5rem;
            font-weight: bold;
            margin: 0;
        }
        /* **10. Voice Type Usage Styling** */
        .voice-usage {
            margin-bottom: 20px;
        }
        .voice-usage .progress {
            height: 25px;
        }
        .voice-usage .progress-bar {
            line-height: 25px;
            font-size: 0.9rem;
        }
        /* **11. Audio Player Section Styling** */
        #audioPlayerSection {
            background-color: #ffffff;
            border: 1px solid #dee2e6;
            border-radius: 10px;
            padding: 20px;
            margin-top: 30px;
            margin-bottom: 30px;
        }
        #audioDropZone {
            background-color: #f8f9fa;
            border: 2px dashed #ced4da;
            border-radius: 5px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: background-color 0.3s, border-color 0.3s;
            margin-bottom: 15px;
        }
        #audioDropZone.dragover {
            background-color: #e9ecef;
            border-color: #495057;
        }
        #audioDropZone i {
            font-size: 2rem;
            color: #6c757d;
            margin-bottom: 10px;
        }
        #audioFileName {
            font-weight: 500;
            color: #495057;
        }
        #mainAudioPlayer {
            width: 100%;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container my-5">
        <h1 class="text-center mb-4">Google TTS Generator</h1>

        <!-- Tab Navigation -->
        <ul class="nav nav-tabs mb-4" id="mainTabs" role="tablist">
            <li class="nav-item">
                <a class="nav-link active" id="generator-tab" data-toggle="tab" href="#generatorPane" role="tab" aria-controls="generatorPane" aria-selected="true">
                    <i class="fas fa-microphone-alt"></i> Text to Speech
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" id="dashboard-tab" data-toggle="tab" href="#dashboardPane" role="tab" aria-controls="dashboardPane" aria-selected="false">
                    <i class="fas fa-chart-bar"></i> Dashboard
                </a>
            </li>
        </ul>

        <!-- Tab Content -->
        <div class="tab-content" id="mainTabContent">
            <!-- Generator Tab Pane -->
            <div class="tab-pane fade show active" id="generatorPane" role="tabpanel" aria-labelledby="generator-tab">

        <form id="ttsForm">
            <!-- **10.5 Input Mode Toggle** -->
            <div class="input-mode-toggle" id="inputModeToggle">
                <button type="button" class="btn active" id="fileUploadMode" data-mode="file">
                    <i class="fas fa-file-upload"></i> File Upload
                </button>
                <button type="button" class="btn" id="textEditorMode" data-mode="editor">
                    <i class="fas fa-edit"></i> Text Editor
                </button>
            </div>

            <!-- **11. Drag-and-Drop File Upload Section** -->
            <div id="fileUploadContainer">
                <div
                    id="dropZone"
                    class="mb-3"
                >
                    <p>Drag and drop a text file here or click to select one.</p>
                    <input
                        type="file"
                        id="textFile"
                        name="textFile"
                        accept=".txt"
                        hidden
                    />
                </div>
            </div>

            <!-- **11.5 Text Editor Section** -->
            <div id="textEditorContainer">
                <!-- SSML Helper Toolbar -->
                <div class="ssml-toolbar">
                    <button type="button" class="btn btn-outline-secondary" id="ssmlPause" title="Insert pause">
                        <i class="fas fa-pause"></i> Pause
                    </button>
                    <button type="button" class="btn btn-outline-secondary" id="ssmlEmphasis" title="Add emphasis">
                        <i class="fas fa-bold"></i> Emphasis
                    </button>
                    <button type="button" class="btn btn-outline-secondary" id="ssmlSlow" title="Speak slowly">
                        <i class="fas fa-tachometer-alt"></i> Slow
                    </button>
                    <button type="button" class="btn btn-outline-secondary" id="ssmlFast" title="Speak fast">
                        <i class="fas fa-forward"></i> Fast
                    </button>
                    <button type="button" class="btn btn-outline-secondary" id="ssmlWhisper" title="Whisper effect">
                        <i class="fas fa-volume-down"></i> Whisper
                    </button>
                    <button type="button" class="btn btn-outline-secondary" id="ssmlSayAs" title="Say as (number, date, etc.)">
                        <i class="fas fa-hashtag"></i> Say As
                    </button>
                    <div class="ml-auto">
                        <button type="button" class="btn btn-outline-info" id="ssmlHelp" title="SSML Help">
                            <i class="fas fa-question-circle"></i>
                        </button>
                    </div>
                </div>
                <!-- Text Editor -->
                <div class="paragraph-preview-container">
                    <textarea
                        id="textEditor"
                        class="form-control with-toolbar"
                        rows="12"
                        placeholder="Type or paste your text here...

You can use SSML tags for advanced control:
• <break time='500ms'/> - Add pauses
• <emphasis level='strong'>text</emphasis> - Add emphasis
• <prosody rate='slow'>text</prosody> - Control speed

Select any text and click 'Preview Selection' to hear it!"
                    ></textarea>
                </div>
                <div class="d-flex justify-content-between align-items-center mt-2">
                    <div class="char-count" id="editorCharCount">0 characters</div>
                </div>

                <!-- Selection Preview Section -->
                <div id="selectionPreviewContainer">
                    <small class="text-muted">Selected text:</small>
                    <div id="selectedTextDisplay"></div>
                    <button type="button" class="btn btn-sm btn-info" id="previewSelectionBtn">
                        <i class="fas fa-play"></i> Preview Selection
                    </button>
                    <span id="selectionPreviewStatus" class="ml-2 small"></span>
                </div>
            </div>
			
			<!-- **Add Checkbox for Pauses Between Sentences** -->
			<div class="form-group">
                <input type="checkbox" id="addPauses" name="addPauses">
                <label for="addPauses">Add pauses between sentences</label>
            </div>

			<!-- **Add Checkbox for Stripping Comments** -->
			<div class="form-group">
                <input type="checkbox" id="stripComments" name="stripComments">
                <label for="stripComments">Strip comments (// and /* */ and == headers)</label>
                <small class="form-text text-muted" id="strippedCharCount" style="display: none;">
                    Characters after stripping: <span id="cleanCharCount">0</span>
                </small>
            </div>
			
			<!-- **Input for Pause Duration (ms)** -->
            <div class="form-group" id="pauseDurationContainer">
                <label for="pauseDuration">Pause Duration (ms):</label>
                <input type="number" class="form-control" id="pauseDuration" name="pauseDuration" min="0" value="1000">
            </div>
            
            <!-- **12. File Size Display** -->
            <div id="fileSize" class="mb-3"></div>
            
            <!-- **13. Language Selection** -->
            <div class="form-group">
                <label for="language">Language:</label>
                <select class="form-control" id="language" name="language" required>
                    <option value="en-GB">English (UK)</option>
                    <option value="en-US">English (US)</option>
                    <option value="en-AU">English (AU)</option>
                    <option value="nl-NL">Dutch</option>
                    <option value="es-ES">Spanish</option>
					<option value="es-US">Spanish USA</option>
                    <option value="de-DE">German</option>
                    <option value="ja-JP">Japanese</option>
					<option value="it-IT">Italian</option>
                    <option value="fr-FR">French</option>
                    <option value="pt-PT">Portuguese (Portugal)</option>
                    <option value="pt-BR">Portuguese (Brazil)</option>
					<option value="tr-TR">Turkish</option>
                </select>
            </div>
            
            <!-- **14. Voice Selection** -->
            <div class="form-group">
                <label for="voice">Voice:</label>
                <select class="form-control" id="voice" name="voice" required>
                    <option value="">Select a voice</option>
                    <!-- Options will be populated dynamically -->
                </select>
            </div>
            
            <!-- **15. Advanced Settings Toggle Button** -->
            <div class="form-group">
                <button
                    class="btn btn-link"
                    type="button"
                    data-toggle="collapse"
                    data-target="#advancedSettings"
                >
                    Advanced Settings
                </button>
            </div>
            
            <!-- **16. Advanced Settings Section** -->
            <div class="collapse" id="advancedSettings">
                <!-- Speaking Rate -->
                <div class="form-group">
                    <label for="speakingRate">Speaking Rate:</label>
                    <input
                        type="range"
                        class="custom-range"
                        id="speakingRate"
                        name="speakingRate"
                        min="0.25"
                        max="4.0"
                        step="0.01"
                        value="1.0"
                    />
                    <small class="form-text text-muted">
                        Value: <span id="speakingRateValue">1.0</span>
                    </small>
                </div>
                <!-- Pitch -->
                <div class="form-group">
                    <label for="pitch">Pitch:</label>
                    <input
                        type="range"
                        class="custom-range"
                        id="pitch"
                        name="pitch"
                        min="-20.0"
                        max="20.0"
                        step="0.1"
                        value="0"
                    />
                    <small class="form-text text-muted">
                        Value: <span id="pitchValue">0</span>
                    </small>
                </div>
            </div>
            
            <!-- **17. Text Preview and Edit Section** -->
            <div class="form-group">
                <label for="textPreview">Text Preview:</label>
                <textarea
                    id="textPreview"
                    name="textPreview"
                    class="form-control"
                    rows="10"
                    readonly
                ></textarea>
            </div>
            
            <!-- **18. Action Buttons** -->
            <div class="form-group text-center">
                <button type="button" class="btn btn-secondary mr-2" id="testVoiceButton">
                    Test Voice
                </button>
                <button type="submit" class="btn btn-primary">Generate Audio</button>
            </div>
        </form>
        
        <!-- **19. Progress Bar** -->
        <div id="progressContainer" class="progress">
            <div
                id="progressBar"
                class="progress-bar progress-bar-striped progress-bar-animated"
                role="progressbar"
                style="width: 0%;"
                aria-valuenow="0"
                aria-valuemin="0"
                aria-valuemax="100"
            ></div>
        </div>
        
        <!-- **20. Test Sentence Display** -->
        <div id="testSentence" class="mt-4"></div>
        
        <!-- **21. Test Audio Player (for voice testing)** -->
        <audio id="audioPlayer" class="mt-3 w-100" controls style="display: none;"></audio>

        <!-- **22. Result Display** -->
        <div id="result" class="mt-4"></div>

        <!-- **23. Audio Player Section** -->
        <div id="audioPlayerSection">
            <h4><i class="fas fa-headphones"></i> Audio Player</h4>
            <p class="text-muted small">Upload an audio file or generate audio above to play it here.</p>

            <!-- Hidden file input (outside drop zone to prevent event issues) -->
            <input type="file" id="audioFileInput" accept="audio/*" hidden />

            <!-- Audio Drop Zone -->
            <div id="audioDropZone">
                <i class="fas fa-music"></i>
                <p class="mb-0">Drag and drop an audio file here or click to select</p>
                <small class="text-muted">Supports MP3, WAV, OGG, M4A</small>
            </div>

            <!-- Audio File Name Display -->
            <div id="audioFileInfo" style="display: none;">
                <p class="mb-2"><i class="fas fa-file-audio"></i> <span id="audioFileName">No file loaded</span></p>
            </div>

            <!-- Main Audio Player -->
            <audio id="mainAudioPlayer" controls style="display: none;"></audio>

            <!-- Audio Diagnostics -->
            <div class="mt-3">
                <button type="button" class="btn btn-outline-secondary btn-sm" id="testAudioBtn">
                    <i class="fas fa-volume-up"></i> Test Browser Audio
                </button>
                <small class="text-muted ml-2" id="audioTestResult"></small>
            </div>
        </div>

            </div>
            <!-- End of Generator Tab Pane -->

            <!-- Dashboard Tab Pane -->
            <div class="tab-pane fade" id="dashboardPane" role="tabpanel" aria-labelledby="dashboard-tab">

        <!-- **24. Dashboard Section** -->
        <div id="dashboard">
            <h2>Usage Dashboard</h2>
            <!-- **23.1. Summary Cards** -->
            <div class="row mb-4">
                <div class="col-md-4">
                    <div class="summary-card">
                        <h5>Total Usage</h5>
                        <p id="totalUsage">0</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="summary-card">
                        <h5>Unique Voices Used</h5>
                        <p id="uniqueVoices">0</p>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="summary-card">
                        <h5>Current Month Usage</h5>
                        <p id="currentMonthUsage">0</p>
                    </div>
                </div>
            </div>
            <!-- **23.2. Voice Type Usage Tracking** -->
            <div class="voice-usage">
                <h4>Voice Type Consumption</h4>
                <div id="voiceUsageCards" class="row">
                    <!-- Voice usage cards will be populated dynamically -->
                </div>
            </div>
            <!-- **23.3. Charts** -->
            <div class="row">
                <div class="col-md-6">
                    <canvas id="usageChart"></canvas>
                </div>
                <div class="col-md-6">
                    <canvas id="voiceTypeChart"></canvas>
                </div>
            </div>
        </div>

            </div>
            <!-- End of Dashboard Tab Pane -->

        </div>
        <!-- End of Tab Content -->

    </div>

    <!-- **24. Included jQuery and Bootstrap JS** -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script
        src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"
    ></script>
    
    <!-- **25. Included External app_client.js for Custom Scripts** -->
    <script src="app_client.js"></script>
</body>
</html>
